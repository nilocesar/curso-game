async function getDocumentsOrderedByField(e,n){try{var t=await e.orderBy(n,"desc").get();if(t.empty)return console.log("No matching documents."),[];let o=[];return t.forEach(e=>{o.push({id:e.id,data:e.data()})}),o}catch(e){return console.error("Error retrieving documents: ",e),[]}}async function updateIfGreater(e,t,r,a){try{await e.runTransaction(async e=>{var o=await e.get(t);if(!o.exists)throw new Error("Document does not exist!");var n=[o.data().game1||0,o.data().game2||0,o.data().game3||0],o=(n.sort(function(e,o){return o-e}),o.data()[r]||0);o<a?(e.update(t,{[r]:a,maior:n[0]<a?a:n[0]}),console.log("Field updated because the new value is greater.")):console.log("Field not updated because the new value is not greater.")})}catch(e){console.error("Transaction failed: ",e)}}function addOrUpdateDocument(o,n){try{o.get().then(e=>{e.exists?(console.log("update",o),o.update({name:n.name,email:n.email,empresa:n.empresa,informativo:n.informativo,uid:n.uid}).then(()=>{console.log("Document successfully update!")}).catch(e=>{console.error("Error update: ",e)})):(console.log("set",o),o.set({name:n.name,email:n.email,empresa:n.empresa,informativo:n.informativo,uid:n.uid}).then(()=>{console.log("Document successfully written!")}).catch(e=>{console.error("Error writing document: ",e)}))}).catch(e=>{console.log("Error set:",e)})}catch(e){console.error("Erro ao adicionar ou atualizar documento: ",e)}}function listenToUpdates(e,o){let n=!0;e.onSnapshot(e=>{n?n=!1:e.docChanges().forEach(e=>{"added"===e.type&&(console.log("New document: ",e.doc.data()),o(e)),"modified"===e.type&&(console.log("Modified document: ",e.doc.data()),o(e))})},e=>{console.log("Encountered error: "+e)})}window.firebaseConfig={apiKey:"AIzaSyDO8szM3aElGhru1hPFGDPmPqoqLvFtb40",authDomain:"lorem-game-portfolio.firebaseapp.com",projectId:"lorem-game-portfolio",storageBucket:"lorem-game-portfolio.appspot.com",messagingSenderId:"773271777029",appId:"1:773271777029:web:cee69556db81890ec6d16c"},window.initFirebase=!1,$(document).ready(function(){var e;window.initFirebase||(e=firebase.initializeApp(window.firebaseConfig),window.db=e.firestore(),window.collectionDB=window.db.collection("usuarios"),window.initFirebase=!0)}),bridge.handlerFormDB=function(e){addOrUpdateDocument(window.collectionDB.doc(e.email),e)},bridge.handlerGameDB=function(e,o,n){e=window.collectionDB.doc(e);updateIfGreater(window.db,e,o,n)},bridge.listRankingDB=function(o){getDocumentsOrderedByField(window.collectionDB,"maior").then(e=>{console.log("Documents ordered by field in descending order:"),o(e)}).catch(e=>{console.error("Error in getDocumentsOrderedByField: ",e)})},bridge.handlerSnapshotFormDB=function(e){listenToUpdates(window.collectionDB,e)};
//# sourceMappingURL=useFirebase.js.map
